<!doctype html><html lang="en-US"><head><title>Characteristic Functions and Stable Distributions - Jim Killingsworth</title><meta charset="utf-8"/><meta name="referrer" content="no-referrer-when-downgrade"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="description" content="In the previous post, I explored the use of the generalized normal distribution to model the price movements of financial instruments. This approach offered better fitting distributions than the normal and Laplace distributions studied in earlier posts. But the shape of the fitted distributions still didn’t quite match the shape of the histogram. In this post, I want to explore a class of probability distributions known as Lévy alpha-stable distributions. And to explore these distributions, we need to understand characteristic functions."/><base href="/"/><link rel="canonical" href="https://jkillingsworth.com/2022/08/17/characteristic-functions-and-stable-distributions/"/><link rel="icon" href="./static/favicon.ico" type="image/x-icon"/><link rel="icon" href="./static/favicon-256.jpg" sizes="256x256"/><link rel="preload" href="./static/fonts/open-sans-v29-latin-700.woff2" as="font" crossorigin/><link rel="preload" href="./static/fonts/lora-v25-latin-regular.woff2" as="font" crossorigin/><link rel="preload" href="./static/fonts/lora-v25-latin-italic.woff2" as="font" crossorigin/><link rel="preload" href="./static/fonts/roboto-mono-v22-latin-regular.woff2" as="font" crossorigin/><script src="https://www.googletagmanager.com/gtag/js?id=G-KP25LH29N8" async></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag("js", new Date());
  gtag("config", "G-KP25LH29N8");
</script><style>@font-face{font-display:swap;font-family:"Open Sans";font-style:normal;font-weight:700;src:local("Open Sans Bold"),local("OpenSans-Bold"),url(./static/fonts/open-sans-v29-latin-700.woff2) format("woff2"),url(./static/fonts/open-sans-v29-latin-700.woff) format("woff")}@font-face{font-display:swap;font-family:"Lora";font-style:normal;font-weight:400;src:local("Lora Regular"),local("Lora-Regular"),url(./static/fonts/lora-v25-latin-regular.woff2) format("woff2"),url(./static/fonts/lora-v25-latin-regular.woff) format("woff")}@font-face{font-display:swap;font-family:"Lora";font-style:italic;font-weight:400;src:local("Lora Italic"),local("Lora-Italic"),url(./static/fonts/lora-v25-latin-italic.woff2) format("woff2"),url(./static/fonts/lora-v25-latin-italic.woff) format("woff")}@font-face{font-display:swap;font-family:"Roboto Mono";font-style:normal;font-weight:400;src:local("Roboto Mono"),local("RobotoMono-Regular"),url(./static/fonts/roboto-mono-v22-latin-regular.woff2) format("woff2"),url(./static/fonts/roboto-mono-v22-latin-regular.woff) format("woff")}
/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:0.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace, monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace, monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-0.25em}sup{top:-0.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,[type="button"],[type="reset"],[type="submit"]{-webkit-appearance:button}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:0.35em 0.75em 0.625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px}[type="search"]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}
html{box-sizing:border-box;overflow-y:scroll}*,*::before,*::after{box-sizing:inherit}body{font-family:"Lora", "Georgia", serif;font-weight:normal;background:#fff;color:#000;display:flex;flex-flow:row wrap;font-size:12pt;justify-content:space-between;line-height:1.5;margin:0 auto;width:90%}body>*{flex:100%}body>header{font-size:21pt;margin:10px 0}body>footer{border-top:3px solid gray;font-size:10pt;font-style:italic;padding:16px 0}header,nav,h1,h2{font-family:"Open Sans", "Verdana", sans-serif;font-weight:bold}header a,nav a,h1 a,h2 a{color:inherit}a{color:#0050ff;text-decoration:none}a:hover{color:#0050ff;text-decoration:underline}strong{font-family:"Open Sans", "Verdana", sans-serif;font-weight:bold}svg{fill:currentColor}.navmenu{border-top:3px solid gray;border-bottom:1px solid #ccc}.navmenu #toggle{float:right;height:24px;margin:4px 0;width:24px}.navmenu #toggle+label{color:transparent;cursor:pointer;display:block;padding:4px 0;position:relative;user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-user-select:none}.navmenu #toggle+label::before{background:#fff;background-size:24px;content:"";float:right;height:24px;left:24px;position:relative;width:24px}.navmenu #toggle+label::after{content:"Menu";left:0;padding:0 16px;position:absolute}.navmenu #toggle+label{border-bottom:none}.navmenu #toggle+label::before{background-image:url("./static/chevron-down.svg")}.navmenu #toggle+label::after{color:#000}.navmenu #toggle~ul{height:0;visibility:hidden}.navmenu #toggle:checked+label{border-bottom:1px solid #e6e6e6}.navmenu #toggle:checked+label::before{background-image:url("./static/chevron-up.svg")}.navmenu #toggle:checked+label::after{color:gray}.navmenu #toggle:checked~ul{height:auto;visibility:visible}.navmenu ul{display:flex;flex-flow:column wrap;list-style-type:none;justify-content:flex-start;margin:0;overflow:hidden;padding:0}.navmenu ul>li{flex:none}.navmenu ul>li a{display:block;padding:4px 16px}.navmenu ul>li a:hover,.navmenu ul>li a:focus{background:gray;color:#fff}.content{max-width:720px}.content header,.content footer,.content h1,.content h2,.content p,.content ul,.content figure{margin:24px 0}.content h1{font-size:18pt}.content h2{font-size:12pt}.content footer{font-style:italic}.content p:last-of-type::after{clear:both;content:"";display:block}.content ul{padding-left:16px}.content ul>li{margin:12px 0}.content figure{max-width:90vw}.content figure>img{display:block}.content .fig-chart{padding-top:56.25%;page-break-inside:avoid;position:relative}.content .fig-chart>img{max-height:100%;max-width:100%;position:absolute;top:0}.content .fig-latex{overflow-x:auto}.content .fig-latex>img{margin:0 16px}.content .fig-pic-l>img,.content .fig-pic-r>img{margin:0 auto;max-width:100%;object-fit:cover}.content .button{font-family:"Open Sans", "Verdana", sans-serif;font-weight:bold;background:#e6e6e6;color:inherit;display:block;margin:24px 0;padding:4px 0;text-align:center}.content .button:hover,.content .button:focus{background:gray;color:#fff}.content .message header>h1{background:#ffff60;display:inline-block;font-size:12pt;margin:0;text-transform:lowercase}.content .message header>h1::first-letter{text-transform:uppercase}.content .message header>h1::after{content:":"}.content .message p{font-style:italic}.content .newpost header>h1{background:#ffff60;display:inline-block;font-size:12pt;margin:0;text-transform:lowercase}.content .newpost header>h1::first-letter{text-transform:uppercase}.content .newpost header>h1::after{content:":"}.content .newpost header>h2{font-size:18pt}.content .newpost a.readmore{background:#e8f0ff}.content .newpost a.readmore::after{content:" \00bb"}.content .newpost a:not(.readmore):not(:hover){color:inherit}.content .oldpost{margin:24px 0}.content .oldpost header>h1{display:none}.content .archive ul>li time{font-family:"Roboto Mono", "Consolas", "Menlo", monospace;font-weight:normal;display:none;font-size:10pt}.content .contact label,.content .contact input[type="submit"]{font-family:"Open Sans", "Verdana", sans-serif;font-weight:bold;cursor:pointer;display:block;margin:16px 0}.content .contact label{margin-bottom:4px}.content .contact input[type="text"],.content .contact input[type="email"],.content .contact textarea{font-family:"Roboto Mono", "Consolas", "Menlo", monospace;font-weight:normal;display:block;font-size:10pt;line-height:inherit;padding:4px;width:100%}.content .contact textarea{height:200px;max-width:100%;min-width:100%}.content .contact input[type="submit"]{padding:4px 40px}.content .comments{margin:24px 0 8px}.content .comments header>h2{display:none}.content .comments noscript{font-family:"Roboto Mono", "Consolas", "Menlo", monospace;font-weight:normal;display:block;font-size:10pt;margin:-12px 0 24px}.sidebar header>h1{display:none}.sidebar header>h2{border-bottom:1px solid #ccc;border-top:3px solid gray;font-size:inherit;margin:0;padding:4px 0}.sidebar section{margin:24px 0}.sidebar section:first-of-type{margin-top:0}.sidebar .social-media ul{list-style:none;padding:0 0 0 16px}.sidebar .social-media ul>li a{display:inline-block}.sidebar .social-media ul>li a *{vertical-align:middle}.sidebar .social-media ul>li a span{margin:0 10px}.sidebar .social-media ul>li a svg{color:gray;height:48px;width:48px}.sidebar .social-media ul>li a:hover svg{color:inherit}.content p:not(.nojustify),.sidebar p:not(.nojustify){text-align:justify;word-spacing:-1px}.content p,.content ul,.sidebar p,.sidebar ul{line-height:1.667}@media only screen and (min-width: 600px){.content ul{padding-left:40px}.content ul>li{margin:0}.content .fig-latex>img{margin:0 40px}.content .fig-pic-l>img{float:left;margin:0 24px 0 0}.content .fig-pic-r>img{float:right;margin:0 0 0 24px}.content .archive ul>li time{display:inline}body{max-width:720px}body>header{font-size:24pt}.navmenu #toggle{display:none}.navmenu #toggle+label{display:none}.navmenu #toggle~ul{height:auto;visibility:visible}.navmenu ul{flex-flow:row wrap}.navmenu ul>li a{padding:4px 32px}}@media only screen and (min-width: 1200px){body{column-gap:60px;max-width:1200px;min-width:1080px}body>header{text-align:center}.content{flex:auto;width:720px}.sidebar{flex:auto}.sidebar section:first-of-type{margin-top:40px}}@media only print{.content ul{padding-left:40px}.content ul>li{margin:0}.content .fig-latex>img{margin:0 40px}.content .fig-pic-l>img{float:left;margin:0 24px 0 0}.content .fig-pic-r>img{float:right;margin:0 0 0 24px}.content .archive ul>li time{display:inline}body{display:block;margin:auto;width:125%}body>header{border-bottom:1px solid #ccc;border-top:3px solid gray;font-size:inherit;margin:0;padding:4px 0;text-align:left}.content figure{max-width:100%}.navmenu,.sidebar,.oldpost,.comments{display:none}}@page{margin:1in 1.25in}
</style></head><body><header><a href="./">Jim Killingsworth</a></header><nav class="navmenu"><input id="toggle" type="checkbox"/><label for="toggle">Enable menu</label><ul><li><a href="./"> Home </a></li><li><a href="./archive/"> Archive </a></li><li><a href="./about/"> About </a></li><li><a href="./contact/"> Contact </a></li></ul></nav><main class="content"><article><header><h1>Char­ac­ter­is­tic Func­tions and Sta­ble Dis­tri­b­u­tions</h1></header><p>In the <a href="/2022/07/07/generalized-normal-distributions/">pre­vi­ous post</a>, I ex­plored the use of the gen­er­al­ized nor­mal dis­tri­b­u­tion to mod­el the price move­ments of fi­nan­cial in­stru­ments. This ap­proach of­fered bet­ter fit­ting dis­tri­b­u­tions than the nor­mal and Laplace dis­tri­b­u­tions stud­ied in ear­li­er post­s. But the shape of the fit­ted dis­tri­b­u­tions still did­n’t quite match the shape of the his­togram. In this post, I want to ex­plore a class of prob­a­bil­i­ty dis­tri­b­u­tions known as Lévy al­pha-stable dis­tri­b­u­tion­s. And to ex­plore these dis­tri­b­u­tion­s, we need to un­der­stand char­ac­ter­is­tic func­tion­s.</p><h2 id="characteristic-functions">Char­ac­ter­is­tic Func­tions</h2><p>In my mind, the most in­tu­itive rep­re­sen­ta­tion of a prob­a­bil­i­ty dis­tri­b­u­tion is a prob­a­bil­i­ty den­si­ty func­tion. But there are oth­er pos­si­ble ways to rep­re­sent a prob­a­bil­i­ty dis­tri­b­u­tion. You could, for ex­am­ple, use a cu­mu­la­tive dis­tri­b­u­tion func­tion in­stead. An­oth­er al­ter­na­tive is to use a char­ac­ter­is­tic func­tion. The char­ac­ter­is­tic func­tion of a prob­a­bil­i­ty dis­tri­b­u­tion is just the Fouri­er trans­form of its den­si­ty func­tion:</p><figure class="fig-latex"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-01-latex-1461901859.svg" alt="Figure 1" height="50"></figure><p>As shown above, if you know the for­mu­la for the prob­a­bil­i­ty den­si­ty func­tion, you can com­pute the char­ac­ter­is­tic func­tion by eval­u­at­ing the in­te­gral. Like­wise, if you know the for­mu­la for the char­ac­ter­is­tic func­tion, you can work out the prob­a­bil­i­ty den­si­ty func­tion by tak­ing the in­verse trans­for­m, as shown be­low:</p><figure class="fig-latex"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-02-latex-1284754201.svg" alt="Figure 2" height="50"></figure><p>There are a va­ri­ety of dif­fer­ent pur­pos­es for which char­ac­ter­is­tic func­tions can be use­ful. Char­ac­ter­is­tic func­tions can be used to sim­pli­fy the con­vo­lu­tion op­er­a­tion, for ex­am­ple. There are al­so prob­a­bil­i­ty dis­tri­b­u­tions that can be clean­ly rep­re­sent­ed us­ing char­ac­ter­is­tic func­tions but do not have prob­a­bil­i­ty den­si­ty func­tions that can be ex­pressed in closed for­m.</p><h2 id="stable-distributions">Sta­ble Dis­tri­b­u­tions</h2><p>Ex­cept for a small num­ber of cas­es, the Lévy al­pha-sta­ble dis­tri­b­u­tion does not have a prob­a­bil­i­ty den­si­ty func­tion that can be ex­pressed an­a­lyt­i­cal­ly. How­ev­er, it is pos­si­ble to rep­re­sent the prob­a­bil­i­ty den­si­ty func­tion in terms of the char­ac­ter­is­tic func­tion. Here is the gen­er­al form of the char­ac­ter­is­tic func­tion for stable dis­tri­b­u­tion­s:</p><figure class="fig-latex"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-03-latex-2797476504.svg" alt="Figure 3" height="238"></figure><p>The lo­ca­tion pa­ra­me­ter can be neg­a­tive or pos­i­tive. The scale pa­ra­me­ter is al­ways a pos­i­tive num­ber. The shape pa­ra­me­ter must be a pos­i­tive num­ber no greater than two, while the skew pa­ra­me­ter can range from neg­a­tive one to pos­i­tive one. For the sake of sim­plic­i­ty, let’s drop the skew pa­ra­me­ter and as­sume the skew is al­ways ze­ro. Omit­ting the skew pa­ra­me­ter sim­pli­fies the char­ac­ter­is­tic func­tion to the fol­low­ing:</p><figure class="fig-latex"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-04-latex-2431039479.svg" alt="Figure 4" height="24"></figure><p>This is the char­ac­ter­is­tic func­tion for the sym­met­ric al­pha-stable dis­tri­b­u­tion. The cor­re­spond­ing prob­a­bil­i­ty den­si­ty func­tion is sym­met­ric with re­spect to the lo­ca­tion pa­ra­me­ter. Us­ing the char­ac­ter­is­tic func­tion above, we can com­pute the prob­a­bil­i­ty den­si­ty func­tion like this:</p><figure class="fig-latex"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-05-latex-1368614451.svg" alt="Figure 5" height="50"></figure><p>We can use nu­mer­i­cal in­te­gra­tion to eval­u­ate this func­tion and plot charts for spe­cif­ic pa­ra­me­ter val­ues. Hold­ing the lo­ca­tion and scale pa­ra­me­ters con­stant and vary­ing the shape pa­ra­me­ter, we can see what the shape of the den­si­ty func­tion looks like for dif­fer­ent val­ues of the shape pa­ra­me­ter. Here are some il­lus­tra­tions:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-06-shape-0.45.svg" alt="Figure 6" height="405" width="720"></figure><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-07-shape-0.55.svg" alt="Figure 7" height="405" width="720"></figure><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-08-shape-0.75.svg" alt="Figure 8" height="405" width="720"></figure><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-09-shape-1.00.svg" alt="Figure 9" height="405" width="720"></figure><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-10-shape-1.35.svg" alt="Figure 10" height="405" width="720"></figure><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-11-shape-2.00.svg" alt="Figure 11" height="405" width="720"></figure><p>There are two spe­cial cas­es in the ex­am­ples il­lus­trat­ed above. When the shape pa­ra­me­ter is equal to two, the sta­ble dis­tri­b­u­tion is equiv­a­lent to a nor­mal dis­tri­b­u­tion. When the shape pa­ra­me­ter is equal to one, the sta­ble dis­tri­b­u­tion is equiv­a­lent to a Cauchy dis­tri­b­u­tion. For these two spe­cial cas­es, the prob­a­bil­i­ty den­si­ty func­tion can be ex­pressed in closed for­m.</p><h2 id="normal-distribution">Nor­mal Dis­tri­b­u­tion</h2><p>The nor­mal dis­tri­b­u­tion is a spe­cial case of a sta­ble dis­tri­b­u­tion when the shape pa­ra­me­ter equals two. Plug the fol­low­ing val­ues in­to the char­ac­ter­is­tic func­tion:</p><figure class="fig-latex"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-12-latex-0503011602.svg" alt="Figure 12" height="38"></figure><p>With these val­ues, the char­ac­ter­is­tic func­tion now looks like this:</p><figure class="fig-latex"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-13-latex-3432700520.svg" alt="Figure 13" height="24"></figure><p>And we can now find the prob­a­bil­i­ty den­si­ty func­tion based on the char­ac­ter­is­tic func­tion:</p><figure class="fig-latex"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-14-latex-4194293328.svg" alt="Figure 14" height="50"></figure><p>Eval­u­at­ing the in­te­gral, we can ar­rive at the fol­low­ing ex­pres­sion of the nor­mal dis­tri­b­u­tion:</p><figure class="fig-latex"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-15-latex-3955756802.svg" alt="Figure 15" height="47"></figure><p>As shown above, by hold­ing the shape pa­ra­me­ter to a fixed val­ue of two, the den­si­ty func­tion of the sta­ble dis­tri­b­u­tion is equiv­a­lent to that of a nor­mal dis­tri­b­u­tion.</p><h2 id="cauchy-distribution">Cauchy Dis­tri­b­u­tion</h2><p>The Cauchy dis­tri­b­u­tion is a spe­cial case of a sta­ble dis­tri­b­u­tion when the shape pa­ra­me­ter equals one. Plug the fol­low­ing val­ues in­to the char­ac­ter­is­tic func­tion:</p><figure class="fig-latex"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-16-latex-2799298545.svg" alt="Figure 16" height="18"></figure><p>With these val­ues, the char­ac­ter­is­tic func­tion now looks like this:</p><figure class="fig-latex"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-17-latex-1262274627.svg" alt="Figure 17" height="24"></figure><p>And we can now find the prob­a­bil­i­ty den­si­ty func­tion based on the char­ac­ter­is­tic func­tion:</p><figure class="fig-latex"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-18-latex-3566064258.svg" alt="Figure 18" height="50"></figure><p>Eval­u­at­ing the in­te­gral, we can ar­rive at the fol­low­ing ex­pres­sion of the Cauchy dis­tri­b­u­tion:</p><figure class="fig-latex"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-19-latex-2044087370.svg" alt="Figure 19" height="43"></figure><p>As shown above, by hold­ing the shape pa­ra­me­ter to a fixed val­ue of one, the den­si­ty func­tion of the sta­ble dis­tri­b­u­tion is equiv­a­lent to that of a Cauchy dis­tri­b­u­tion.</p><h2 id="numerical-parameter-estimation">Nu­mer­i­cal Pa­ra­me­ter Es­ti­ma­tion</h2><p>We can use the max­i­mum like­li­hood method in the same fash­ion we did in the pre­vi­ous post to fit the lo­ca­tion, scale, and shape pa­ra­me­ters to a sta­ble dis­tri­b­u­tion. Here is the like­li­hood func­tion that we want to max­i­mize:</p><figure class="fig-latex"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-20-latex-1324079957.svg" alt="Figure 20" height="50"></figure><p>To fit a sta­ble dis­tri­b­u­tion to an ob­served set of data, we need to find the pa­ra­me­ter val­ues that max­i­mize this func­tion. For the ex­am­ples ap­pear­ing lat­er in this post, we’re go­ing to use nu­mer­i­cal op­ti­miza­tion to find the most op­ti­mal pa­ra­me­ter val­ues. The cost func­tion we’re go­ing to use is the nega­tion of the log­a­rithm of the like­li­hood func­tion:</p><figure class="fig-latex"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-21-latex-0068727419.svg" alt="Figure 21" height="50"></figure><p>Us­ing nu­mer­i­cal op­ti­miza­tion meth­od­s, we need to start with an ini­tial guess. As with the pre­vi­ous post, I’ve cho­sen to start with a shape pa­ra­me­ter val­ue of two:</p><figure class="fig-latex"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-22-latex-1893659598.svg" alt="Figure 22" height="18"></figure><p>This im­plies a nor­mal dis­tri­b­u­tion. The lo­ca­tion and scale pa­ra­me­ters for a nor­mal dis­tri­b­u­tion are easy to com­pute:</p><figure class="fig-latex"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-23-latex-1091466158.svg" alt="Figure 23" height="59"></figure><p>These are the ini­tial pa­ra­me­ter val­ues for the nu­mer­i­cal op­ti­miza­tion method. Like be­fore, I’m us­ing a third-par­ty im­ple­men­ta­tion of the Nelder–Mead al­go­rith­m. This is an un­con­strained method, so it’s pos­si­ble for the op­ti­miza­tion process to stray out­side the range of valid pa­ra­me­ter val­ues. To off­set this, I’ve mod­i­fied the cost func­tion to re­turn a penal­ty val­ue if the op­ti­miza­tion pro­ce­dure wan­ders out­side the valid range of val­ues for the shape pa­ra­me­ter.</p><h2 id="numerical-integration">Nu­mer­i­cal In­te­gra­tion</h2><p>In ad­di­tion to us­ing nu­mer­i­cal op­ti­miza­tion to find the op­ti­mum pa­ra­me­ter val­ues, we al­so need to use nu­mer­i­cal in­te­gra­tion to eval­u­ate the prob­a­bil­i­ty den­si­ty func­tion for sta­ble dis­tri­b­u­tion­s. I’m us­ing an im­ple­men­ta­tion of the Gauss–Kro­n­rod method for the ex­am­ples in this post. Since nu­mer­i­cal in­te­gra­tion is a com­pute-in­ten­sive eval­u­a­tion method, it can be ben­e­fi­cial to con­sid­er the run­time per­for­mance of the eval­u­a­tion of the in­te­grand. Con­sid­er the fol­low­ing:</p><figure class="fig-latex"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-24-latex-3055077533.svg" alt="Figure 24" height="194"></figure><p>The in­te­grand has a com­plex ex­po­nen­tial, so we can use Euler’s for­mu­la to sep­a­rate the re­al part from the imag­i­nary part. And if we can as­sume the fi­nal re­sult is al­ways a re­al num­ber, we can sim­ply drop the imag­i­nary part en­tire­ly:</p><figure class="fig-latex"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-25-latex-1008211712.svg" alt="Figure 25" height="50"></figure><p>No­tice that, in the for­mu­la above, the in­te­grand is sym­met­ric with re­spect to ze­ro. That means we can do a lit­tle trick where we just in­te­grate over the pos­i­tive half of the in­ter­val and then dou­ble the re­sult:</p><figure class="fig-latex"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-26-latex-2834418870.svg" alt="Figure 26" height="50"></figure><p>With the den­si­ty func­tion for the sta­ble dis­tri­b­u­tion in this for­m, the run­time per­for­mance seems to be im­proved by a fac­tor of five. There are prob­a­bly oth­er op­ti­miza­tions that can be made as well, but this is fast enough for the ex­am­ples in this post.</p><h2 id="microsoft-stock-prices">Mi­crosoft Stock Prices</h2><p>Now let’s look at some ex­am­ples of fit­ting sta­ble dis­tri­b­u­tions to re­al-life da­ta. The first ex­am­ple is based on the his­tor­i­cal stock prices of Mi­crosoft Cor­po­ra­tion. Like we did in the last post, we’ll take the log­a­rithm of the dai­ly clos­ing prices, com­pute the first dif­fer­ences, and then put the data in a his­togram. The fol­low­ing charts show the his­togram over­laid with the fit­ted den­si­ty func­tions for the nor­mal, Cauchy, and gen­er­al­ized sym­met­ric al­pha-stable dis­tri­b­u­tion­s, re­spec­tive­ly:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-27-fitted-MSFT-N.svg" alt="Figure 27" height="405" width="720"></figure><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-28-fitted-MSFT-C.svg" alt="Figure 28" height="405" width="720"></figure><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-29-fitted-MSFT-S.svg" alt="Figure 29" height="405" width="720"></figure><p>The fit­ted sym­met­ric al­pha-stable dis­tri­b­u­tion has the fol­low­ing shape pa­ra­me­ter:</p><figure class="fig-latex"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-30-latex-2424987738.svg" alt="Figure 30" height="15"></figure><p>As ex­pect­ed, the den­si­ty func­tion for the gen­er­al­ized form of the sta­ble dis­tri­b­u­tion ap­pears to be a bet­ter fit than that of ei­ther the nor­mal dis­tri­b­u­tion or the Cauchy dis­tri­b­u­tion. Worth not­ing, how­ev­er, is that the fit­ted curve does­n’t seem to fit the his­togram as tight­ly as the gen­er­al­ized nor­mal den­si­ty func­tion stud­ied in the pre­vi­ous post—sub­jec­tive­ly speak­ing, any­ways.</p><h2 id="bitcoin-prices">Bit­coin Prices</h2><p>This ex­am­ple us­es his­tor­i­cal bit­coin prices. We’ll do the same thing we did in the pre­vi­ous ex­am­ple, tak­ing the first dif­fer­ences of the log­a­rithm of the dai­ly clos­ing prices and putting the da­ta in a his­togram. The fol­low­ing charts show the his­togram over­laid with the fit­ted den­si­ty func­tions for the nor­mal, Cauchy, and gen­er­al­ized sym­met­ric al­pha-stable dis­tri­b­u­tion­s, re­spec­tive­ly:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-31-fitted-BTCUSD-N.svg" alt="Figure 31" height="405" width="720"></figure><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-32-fitted-BTCUSD-C.svg" alt="Figure 32" height="405" width="720"></figure><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-33-fitted-BTCUSD-S.svg" alt="Figure 33" height="405" width="720"></figure><p>The fit­ted sym­met­ric al­pha-stable dis­tri­b­u­tion has the fol­low­ing shape pa­ra­me­ter:</p><figure class="fig-latex"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-34-latex-0149966462.svg" alt="Figure 34" height="14"></figure><p>In this ex­am­ple, the fit­ted den­si­ty func­tion for the Cauchy dis­tri­b­u­tion looks like a bet­ter fit than the den­si­ty func­tion for the gen­er­al­ized form of the sta­ble dis­tri­b­u­tion. This is not what I was ex­pect­ing. The Cauchy dis­tri­b­u­tion is a spe­cial case of the sym­met­ric sta­ble dis­tri­b­u­tion, so the sta­ble dis­tri­b­u­tion should fit at least as well as the Cauchy dis­tri­b­u­tion. But that does­n’t seem to be the case here. I am both­ered by this re­sult.</p><h2 id="natural-gas-prices">Nat­ural Gas Prices</h2><p>The third ex­am­ple us­es the dai­ly clos­ing prices of a nat­ural gas ET­F. Once again, we’ll take the log­a­rithm of the price quotes, com­pute the first dif­fer­ences, and then put the da­ta in­to a his­togram. The fol­low­ing charts show the his­togram over­laid with the fit­ted den­si­ty func­tions for the nor­mal, Cauchy, and gen­er­al­ized sym­met­ric al­pha-stable dis­tri­b­u­tion­s, re­spec­tive­ly:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-35-fitted-UNG-N.svg" alt="Figure 35" height="405" width="720"></figure><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-36-fitted-UNG-C.svg" alt="Figure 36" height="405" width="720"></figure><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-37-fitted-UNG-S.svg" alt="Figure 37" height="405" width="720"></figure><p>The fit­ted sym­met­ric al­pha-stable dis­tri­b­u­tion has the fol­low­ing shape pa­ra­me­ter:</p><figure class="fig-latex"><img src="./2022/08/17/characteristic-functions-and-stable-distributions/fig-38-latex-1096198535.svg" alt="Figure 38" height="14"></figure><p>In this case, the den­si­ty func­tion for the gen­er­al­ized sta­ble dis­tri­b­u­tion seems to fit quite nice­ly. It looks like a bet­ter fit than the den­si­ty func­tion for nor­mal dis­tri­b­u­tion or the Cauchy dis­tri­b­u­tion. And the shape of the den­si­ty func­tion looks like a bet­ter match than that of the gen­er­al­ized nor­mal dis­tri­b­u­tion used in the last post.</p><h2 id="better-methods">Bet­ter Meth­ods</h2><p>I am not hap­py with the re­sults of this ex­per­i­men­t. Com­pared to the gen­er­al­ized nor­mal dis­tri­b­u­tion used in the last post, the shape of the den­si­ty func­tion for the Lévy al­pha-sta­ble dis­tri­b­u­tion seems to be a bet­ter fit for the kind of da­ta used in the ex­am­ples above. How­ev­er, fit­ting the pa­ra­me­ters us­ing the max­i­mum like­li­hood method does­n’t al­ways seem to give the best re­sult­s. I am par­tic­u­lar­ly dis­ap­point­ed with the re­sults based on the bit­coin price da­ta. And I think there might be bet­ter fit­ting pa­ra­me­ters for the oth­er da­ta sets as well. Since stable dis­tri­b­u­tions have heavy tail­s, I sus­pect that a dearth of sam­ple data deep in the tails might be throw­ing off the pa­ra­me­ter es­ti­mates. It might be worth do­ing a fol­low-up study to ex­per­i­ment with dif­fer­ent fit­ting meth­ods that might yield a bet­ter re­sult.</p><p class="nojustify"><a href="https://github.com/jkillingsworth/jkillingsworth.com/tree/master/src/2022-08-17-characteristic-functions-and-stable-distributions">Ac­com­pa­ny­ing source code is avail­able on GitHub.</a></p><footer><time datetime="2022-08-17">August 17, 2022</time></footer></article><section class="comments"><header><h2>Com­ments</h2></header><script>
    var disqus_config = function () {
      this.page.url = "https://jkillingsworth.com/2022/08/17/characteristic-functions-and-stable-distributions/";
      this.page.title = "Characteristic Functions and Stable Distributions";
      this.page.identifier = "/2022/08/17/characteristic-functions-and-stable-distributions/";
    };
    function disqus_show() {
      var d = document, s = d.createElement("script");
      s.src = "https://jkillingsworth.disqus.com/embed.js";
      s.setAttribute("data-timestamp", +new Date());
      (d.head || d.body).appendChild(s);
    }
    function anchor_blur() {
      var a = document.getElementById("comments");
      a.innerText = "Comments";
      a.blur();
    }
    function disqus() {
      disqus_show();
      anchor_blur();
    }
  </script><a href="javascript:disqus();" id="comments" class="button">Show comments</a><div id="disqus_thread"></div><noscript> Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></section></main><aside class="sidebar"><header><h1>Sidebar</h1></header><section class="social-media"><header><h2>Social Media</h2></header><ul><li><a href="https://www.linkedin.com/in/jkillingsworth/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M417.2 64H96.8C79.3 64 64 76.6 64 93.9V415c0 17.4 15.3 32.9 32.8 32.9h320.3c17.6 0 30.8-15.6 30.8-32.9V93.9C448 76.6 434.7 64 417.2 64zM183 384h-55V213h55v171zm-25.6-197h-.4c-17.6 0-29-13.1-29-29.5 0-16.7 11.7-29.5 29.7-29.5s29 12.7 29.4 29.5c0 16.4-11.4 29.5-29.7 29.5zM384 384h-55v-93.5c0-22.4-8-37.7-27.9-37.7-15.2 0-24.2 10.3-28.2 20.3-1.5 3.6-1.9 8.5-1.9 13.5V384h-55V213h55v23.8c8-11.4 20.5-27.8 49.6-27.8 36.1 0 63.4 23.8 63.4 75.1V384z"/></svg><span>LinkedIn</span></a></li><li><a href="https://github.com/jkillingsworth/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 32C132.3 32 32 134.9 32 261.7c0 101.5 64.2 187.5 153.2 217.9 1.4.3 2.6.4 3.8.4 8.3 0 11.5-6.1 11.5-11.4 0-5.5-.2-19.9-.3-39.1-8.4 1.9-15.9 2.7-22.6 2.7-43.1 0-52.9-33.5-52.9-33.5-10.2-26.5-24.9-33.6-24.9-33.6-19.5-13.7-.1-14.1 1.4-14.1h.1c22.5 2 34.3 23.8 34.3 23.8 11.2 19.6 26.2 25.1 39.6 25.1 10.5 0 20-3.4 25.6-6 2-14.8 7.8-24.9 14.2-30.7-49.7-5.8-102-25.5-102-113.5 0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8 0 0 1.6-.5 5-.5 8.1 0 26.4 3.1 56.6 24.1 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 30.2-21 48.5-24.1 56.6-24.1 3.4 0 5 .5 5 .5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6 0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5 0 30.7-.3 55.5-.3 63 0 5.4 3.1 11.5 11.4 11.5 1.2 0 2.6-.1 4-.4C415.9 449.2 480 363.1 480 261.7 480 134.9 379.7 32 256 32z"/></svg><span>GitHub</span></a></li></ul></section></aside><footer> &copy; 2018&ndash;2022 Jim Killingsworth. All rights reserved. </footer></body></html>