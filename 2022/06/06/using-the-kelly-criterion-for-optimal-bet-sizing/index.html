<!doctype html><html lang="en-US"><head><title>Using the Kelly Criterion for Optimal Bet Sizing - Jim Killingsworth</title><meta charset="utf-8"/><meta name="referrer" content="no-referrer-when-downgrade"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="description" content="Suppose a gambler is playing a game in which he has a statistical advantage. And letâ€™s assume he can quantify his advantage with a fair amount of accuracy. If the gambler plays this game over and over again, what percentage of his bankroll should he bet on each round if he wants to maximize his winnings? In this post, I explore this question using a series of examples illustrating the application of the Kelly criterion. Many of the ideas presented here are inspired by materials written by Ed Seykota, Edward O. Thorp, and J. L. Kelly."/><base href="/"/><link rel="canonical" href="https://jkillingsworth.com/2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/"/><link rel="icon" href="./static/favicon.ico" type="image/x-icon"/><link rel="icon" href="./static/favicon-256.jpg" sizes="256x256"/><link rel="preload" href="./static/fonts/open-sans-v29-latin-700.woff2" as="font" crossorigin/><link rel="preload" href="./static/fonts/lora-v25-latin-regular.woff2" as="font" crossorigin/><link rel="preload" href="./static/fonts/lora-v25-latin-italic.woff2" as="font" crossorigin/><link rel="preload" href="./static/fonts/roboto-mono-v22-latin-regular.woff2" as="font" crossorigin/><script src="https://www.googletagmanager.com/gtag/js?id=G-KP25LH29N8" async></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag("js", new Date());
  gtag("config", "G-KP25LH29N8");
</script><style>@font-face{font-display:swap;font-family:"Open Sans";font-style:normal;font-weight:700;src:local("Open Sans Bold"),local("OpenSans-Bold"),url(./static/fonts/open-sans-v29-latin-700.woff2) format("woff2"),url(./static/fonts/open-sans-v29-latin-700.woff) format("woff")}@font-face{font-display:swap;font-family:"Lora";font-style:normal;font-weight:400;src:local("Lora Regular"),local("Lora-Regular"),url(./static/fonts/lora-v25-latin-regular.woff2) format("woff2"),url(./static/fonts/lora-v25-latin-regular.woff) format("woff")}@font-face{font-display:swap;font-family:"Lora";font-style:italic;font-weight:400;src:local("Lora Italic"),local("Lora-Italic"),url(./static/fonts/lora-v25-latin-italic.woff2) format("woff2"),url(./static/fonts/lora-v25-latin-italic.woff) format("woff")}@font-face{font-display:swap;font-family:"Roboto Mono";font-style:normal;font-weight:400;src:local("Roboto Mono"),local("RobotoMono-Regular"),url(./static/fonts/roboto-mono-v22-latin-regular.woff2) format("woff2"),url(./static/fonts/roboto-mono-v22-latin-regular.woff) format("woff")}
/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:0.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace, monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace, monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-0.25em}sup{top:-0.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,[type="button"],[type="reset"],[type="submit"]{-webkit-appearance:button}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:0.35em 0.75em 0.625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px}[type="search"]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}template{display:none}[hidden]{display:none}
html{box-sizing:border-box;overflow-y:scroll}*,*::before,*::after{box-sizing:inherit}body{font-family:"Lora", "Georgia", serif;font-weight:normal;background:#fff;color:#000;display:flex;flex-flow:row wrap;font-size:12pt;justify-content:space-between;line-height:1.5;margin:0 auto;width:90%}body>*{flex:100%}body>header{font-size:21pt;margin:10px 0}body>footer{border-top:3px solid gray;font-size:10pt;font-style:italic;padding:16px 0}header,nav,h1,h2{font-family:"Open Sans", "Verdana", sans-serif;font-weight:bold}header a,nav a,h1 a,h2 a{color:inherit}a{color:#0050ff;text-decoration:none}a:hover{color:#0050ff;text-decoration:underline}strong{font-family:"Open Sans", "Verdana", sans-serif;font-weight:bold}svg{fill:currentColor}.navmenu{border-top:3px solid gray;border-bottom:1px solid #ccc}.navmenu #toggle{float:right;height:24px;margin:4px 0;width:24px}.navmenu #toggle+label{color:transparent;cursor:pointer;display:block;padding:4px 0;position:relative;user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-user-select:none}.navmenu #toggle+label::before{background:#fff;background-size:24px;content:"";float:right;height:24px;left:24px;position:relative;width:24px}.navmenu #toggle+label::after{content:"Menu";left:0;padding:0 16px;position:absolute}.navmenu #toggle+label{border-bottom:none}.navmenu #toggle+label::before{background-image:url("./static/chevron-down.svg")}.navmenu #toggle+label::after{color:#000}.navmenu #toggle~ul{height:0;visibility:hidden}.navmenu #toggle:checked+label{border-bottom:1px solid #e6e6e6}.navmenu #toggle:checked+label::before{background-image:url("./static/chevron-up.svg")}.navmenu #toggle:checked+label::after{color:gray}.navmenu #toggle:checked~ul{height:auto;visibility:visible}.navmenu ul{display:flex;flex-flow:column wrap;list-style-type:none;justify-content:flex-start;margin:0;overflow:hidden;padding:0}.navmenu ul>li{flex:none}.navmenu ul>li a{display:block;padding:4px 16px}.navmenu ul>li a:hover,.navmenu ul>li a:focus{background:gray;color:#fff}.content{max-width:720px}.content header,.content footer,.content h1,.content h2,.content p,.content ul,.content figure{margin:24px 0}.content h1{font-size:18pt}.content h2{font-size:12pt}.content footer{font-style:italic}.content p:last-of-type::after{clear:both;content:"";display:block}.content ul{padding-left:16px}.content ul>li{margin:12px 0}.content figure{max-width:90vw}.content figure>img{display:block}.content .fig-chart{padding-top:56.25%;page-break-inside:avoid;position:relative}.content .fig-chart>img{max-height:100%;max-width:100%;position:absolute;top:0}.content .fig-latex{overflow-x:auto}.content .fig-latex>img{margin:0 16px}.content .fig-pic-l>img,.content .fig-pic-r>img{margin:0 auto;max-width:100%;object-fit:cover}.content .button{font-family:"Open Sans", "Verdana", sans-serif;font-weight:bold;background:#e6e6e6;color:inherit;display:block;margin:24px 0;padding:4px 0;text-align:center}.content .button:hover,.content .button:focus{background:gray;color:#fff}.content .message header>h1{background:#ffff60;display:inline-block;font-size:12pt;margin:0;text-transform:lowercase}.content .message header>h1::first-letter{text-transform:uppercase}.content .message header>h1::after{content:":"}.content .message p{font-style:italic}.content .newpost header>h1{background:#ffff60;display:inline-block;font-size:12pt;margin:0;text-transform:lowercase}.content .newpost header>h1::first-letter{text-transform:uppercase}.content .newpost header>h1::after{content:":"}.content .newpost header>h2{font-size:18pt}.content .newpost a.readmore{background:#e8f0ff}.content .newpost a.readmore::after{content:" \00bb"}.content .newpost a:not(.readmore):not(:hover){color:inherit}.content .oldpost{margin:24px 0}.content .oldpost header>h1{display:none}.content .archive ul>li time{font-family:"Roboto Mono", "Consolas", "Menlo", monospace;font-weight:normal;display:none;font-size:10pt}.content .contact label,.content .contact input[type="submit"]{font-family:"Open Sans", "Verdana", sans-serif;font-weight:bold;cursor:pointer;display:block;margin:16px 0}.content .contact label{margin-bottom:4px}.content .contact input[type="text"],.content .contact input[type="email"],.content .contact textarea{font-family:"Roboto Mono", "Consolas", "Menlo", monospace;font-weight:normal;display:block;font-size:10pt;line-height:inherit;padding:4px;width:100%}.content .contact textarea{height:200px;max-width:100%;min-width:100%}.content .contact input[type="submit"]{padding:4px 40px}.content .comments{margin:24px 0 8px}.content .comments header>h2{display:none}.content .comments noscript{font-family:"Roboto Mono", "Consolas", "Menlo", monospace;font-weight:normal;display:block;font-size:10pt;margin:-12px 0 24px}.sidebar header>h1{display:none}.sidebar header>h2{border-bottom:1px solid #ccc;border-top:3px solid gray;font-size:inherit;margin:0;padding:4px 0}.sidebar section{margin:24px 0}.sidebar section:first-of-type{margin-top:0}.sidebar .social-media ul{list-style:none;padding:0 0 0 16px}.sidebar .social-media ul>li a{display:inline-block}.sidebar .social-media ul>li a *{vertical-align:middle}.sidebar .social-media ul>li a span{margin:0 10px}.sidebar .social-media ul>li a svg{color:gray;height:48px;width:48px}.sidebar .social-media ul>li a:hover svg{color:inherit}.content p:not(.nojustify),.sidebar p:not(.nojustify){text-align:justify;word-spacing:-1px}.content p,.content ul,.sidebar p,.sidebar ul{line-height:1.667}@media only screen and (min-width: 600px){.content ul{padding-left:40px}.content ul>li{margin:0}.content .fig-latex>img{margin:0 40px}.content .fig-pic-l>img{float:left;margin:0 24px 0 0}.content .fig-pic-r>img{float:right;margin:0 0 0 24px}.content .archive ul>li time{display:inline}body{max-width:720px}body>header{font-size:24pt}.navmenu #toggle{display:none}.navmenu #toggle+label{display:none}.navmenu #toggle~ul{height:auto;visibility:visible}.navmenu ul{flex-flow:row wrap}.navmenu ul>li a{padding:4px 32px}}@media only screen and (min-width: 1200px){body{column-gap:60px;max-width:1200px;min-width:1080px}body>header{text-align:center}.content{flex:auto;width:720px}.sidebar{flex:auto}.sidebar section:first-of-type{margin-top:40px}}@media only print{.content ul{padding-left:40px}.content ul>li{margin:0}.content .fig-latex>img{margin:0 40px}.content .fig-pic-l>img{float:left;margin:0 24px 0 0}.content .fig-pic-r>img{float:right;margin:0 0 0 24px}.content .archive ul>li time{display:inline}body{display:block;margin:auto;width:125%}body>header{border-bottom:1px solid #ccc;border-top:3px solid gray;font-size:inherit;margin:0;padding:4px 0;text-align:left}.content figure{max-width:100%}.navmenu,.sidebar,.oldpost,.comments{display:none}}@page{margin:1in 1.25in}
</style></head><body><header><a href="./">Jim Killingsworth</a></header><nav class="navmenu"><input id="toggle" type="checkbox"/><label for="toggle">Enable menu</label><ul><li><a href="./"> Home </a></li><li><a href="./archive/"> Archive </a></li><li><a href="./about/"> About </a></li><li><a href="./contact/"> Contact </a></li></ul></nav><main class="content"><article><header><h1>UsÂ­ing the KelÂ­ly CriÂ­teÂ­riÂ­on for OpÂ­tiÂ­mal Bet SizÂ­ing</h1></header><p>SupÂ­pose a gamÂ­bler is playÂ­ing a game in which he has a staÂ­tisÂ­tiÂ­cal adÂ­vanÂ­tage. And letâ€™s asÂ­sume he can quanÂ­tiÂ­fy his adÂ­vanÂ­tage with a fair amount of acÂ­cuÂ­raÂ­cy. If the gamÂ­bler plays this game over and over again, what perÂ­centÂ­age of his bankroll should he bet on each round if he wants to maxÂ­iÂ­mize his winÂ­nings? In this post, I exÂ­plore this quesÂ­tion usÂ­ing a seÂ­ries of exÂ­amÂ­ples ilÂ­lusÂ­tratÂ­ing the apÂ­pliÂ­caÂ­tion of the KelÂ­ly criÂ­teÂ­riÂ­on. Many of the ideas preÂ­sentÂ­ed here are inÂ­spired by maÂ­teÂ­riÂ­als writÂ­ten by Ed SeykoÂ­ta, EdÂ­ward O. ThorÂ­p, and J. L. KelÂ­ly.</p><h2 id="repeated-coin-toss-game">ReÂ­peatÂ­ed Coin Toss Game</h2><p>For our first exÂ­amÂ­ple, letâ€™s conÂ­sidÂ­er a reÂ­peatÂ­ed coin toss game. The gamÂ­bler bets on the outÂ­come of a coin toss. If he preÂ­dicts the outÂ­come corÂ­rectÂ­ly, he wins an amount equivÂ­aÂ­lent to the size of his bet. If he is wrong, he losÂ­es the amount he waÂ­gered. In this exÂ­amÂ­ple, letâ€™s asÂ­sume the coin is biÂ­ased in such a way that it lands on heads 60% of the time and tails 40% of the time. We can repÂ­reÂ­sent this usÂ­ing the folÂ­lowÂ­ing noÂ­taÂ­tion:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-01-latex-1620035801.svg" alt="Figure 1" height="44"></figure><p>Letâ€™s asÂ­sume the gamÂ­bler is aware of this biÂ­as. Of course, the gamÂ­bler will alÂ­ways bet on headÂ­s. But how much should he bet? Should he bet 10% of his stake? Should he bet 20%? PerÂ­haps he should bet 30%? Maybe more? Maybe less? This is the quesÂ­tion we want to anÂ­swer. If the gamÂ­bler bets too high, he risks deÂ­pletÂ­ing his capÂ­iÂ­tal too quickÂ­ly durÂ­ing a losÂ­ing streak. If he bets too low, his wealth may not grow as quickÂ­ly as it might othÂ­erÂ­wise. We can beÂ­ing to anÂ­swer this quesÂ­tion by conÂ­sidÂ­erÂ­ing an exÂ­amÂ­ple and then conÂ­structÂ­ing a modÂ­el. SupÂ­pose the gamÂ­bler plays 200 rounds of the game and bets 10% on each play:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-02-latex-1370980916.svg" alt="Figure 2" height="40"></figure><p>And supÂ­pose the gamÂ­bler starts with a bankroll of $100:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-03-latex-1594997715.svg" alt="Figure 3" height="18"></figure><p>Based on these numÂ­berÂ­s, we can use the folÂ­lowÂ­ing forÂ­muÂ­la to calÂ­cuÂ­late the size of the gamÂ­blerâ€™s holdÂ­ings afÂ­ter playÂ­ing 200 rounds of the game:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-04-latex-2046805621.svg" alt="Figure 4" height="30"></figure><p>BeÂ­cause there is an elÂ­eÂ­ment of ranÂ­domÂ­ness inÂ­volved, there is no guarÂ­anÂ­tee that we will get the same reÂ­sult every time we comÂ­pute this valÂ­ue. One seÂ­ries of 200 coin tossÂ­es might have a difÂ­ferÂ­ent numÂ­ber of heads and tails than anÂ­othÂ­er seÂ­ries. HowÂ­evÂ­er, the numÂ­ber of heads and the numÂ­ber of tails will alÂ­ways add up to the same amounÂ­t:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-05-latex-1875325070.svg" alt="Figure 5" height="14"></figure><p>To get an idea of what kind of reÂ­sults we can exÂ­pecÂ­t, we can run some simÂ­uÂ­laÂ­tions of the coin toss game usÂ­ing a ranÂ­dom numÂ­ber genÂ­erÂ­aÂ­tor to mimÂ­ic the coin toss. Here is a graphÂ­iÂ­cal repÂ­reÂ­senÂ­taÂ­tion of three such simÂ­uÂ­laÂ­tionÂ­s:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-06-coin-toss-simulations.svg" alt="Figure 6" height="405" width="720"></figure><p>As you can see, these three difÂ­ferÂ­ent simÂ­uÂ­laÂ­tions yield three very difÂ­ferÂ­ent outÂ­comes. The folÂ­lowÂ­ing taÂ­ble sumÂ­maÂ­rizes the reÂ­sultÂ­s:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-07-latex-3731260542.svg" alt="Figure 7" height="135"></figure><p>To esÂ­tiÂ­mate the exÂ­pectÂ­ed valÂ­ue of the gamÂ­blerâ€™s holdÂ­ings afÂ­ter 200 rounds of the coin toss game, we might run this simÂ­uÂ­laÂ­tion many more times and then take the mean of the reÂ­sultÂ­s. That would tell us the exÂ­pectÂ­ed valÂ­ue for a bet size of 10%. We would then have to reÂ­peat this process again for every posÂ­siÂ­ble bet size to deÂ­terÂ­mine which bet size valÂ­ue gives us the highÂ­est exÂ­pectÂ­ed reÂ­sult. That might be a comÂ­puÂ­taÂ­tionÂ­alÂ­ly exÂ­penÂ­sive thing to do. A betÂ­ter apÂ­proach might be to look at this probÂ­lem anÂ­aÂ­lytÂ­iÂ­calÂ­ly. Keep in mind that what we reÂ­alÂ­ly care about here is not the gamÂ­blerâ€™s wealth afÂ­ter a speÂ­cifÂ­ic numÂ­ber of rounds of the coin toss game. What reÂ­alÂ­ly matÂ­ters is the geoÂ­metÂ­ric mean of all the gains and lossÂ­es takÂ­en in agÂ­greÂ­gate:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-08-latex-0511057197.svg" alt="Figure 8" height="49"></figure><p>This gives us a growth rate facÂ­tor inÂ­deÂ­penÂ­dent of the numÂ­ber of plays and the inÂ­deÂ­penÂ­dent of the gamÂ­blerâ€™s startÂ­ing eqÂ­uiÂ­ty. This is the valÂ­ue we want to maxÂ­iÂ­mize. And specifÂ­iÂ­calÂ­ly, what weâ€™re reÂ­alÂ­ly inÂ­terÂ­estÂ­ed in is the exÂ­pectÂ­ed valÂ­ue of the growth rate as a funcÂ­tion of the bet size:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-09-latex-2133647443.svg" alt="Figure 9" height="24"></figure><p>As we will see shortÂ­ly, maxÂ­iÂ­mizÂ­ing the logÂ­aÂ­rithm of the growth rate is goÂ­ing to be more conÂ­veÂ­nient than maxÂ­iÂ­mizÂ­ing the growth rate itÂ­self. For our purÂ­posÂ­es here, we will use the natÂ­ural logÂ­aÂ­rithÂ­m. ConÂ­sidÂ­er the folÂ­lowÂ­ing:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-10-latex-0745853382.svg" alt="Figure 10" height="148"></figure><p>Since the natÂ­ural logÂ­aÂ­rithm is a monotonÂ­iÂ­calÂ­ly inÂ­creasÂ­ing funcÂ­tion, maxÂ­iÂ­mizÂ­ing the growth rate is the same as maxÂ­iÂ­mizÂ­ing its logÂ­aÂ­rithÂ­m. As menÂ­tioned, we are inÂ­terÂ­estÂ­ed in the exÂ­pectÂ­ed valÂ­ue of the growth rate. But in this case, it is the logÂ­aÂ­rithm of the growth rate:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-11-latex-2583958054.svg" alt="Figure 11" height="67"></figure><p>You can think about the exÂ­pectÂ­ed valÂ­ue in terms of the numÂ­ber of heads and the numÂ­ber of tailÂ­s. If you play 200 roundÂ­s, the exÂ­pecÂ­taÂ­tion is that the game will proÂ­duce 120 heads and 80 tailÂ­s. This can vary based on ranÂ­domÂ­ness, but these are the exÂ­pectÂ­ed valÂ­ues. We can plot the funcÂ­tion above to see what it looks like:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-12-example-1-gs.svg" alt="Figure 12" height="405" width="720"></figure><p>UsÂ­ing viÂ­suÂ­al inÂ­specÂ­tion, we can obÂ­serve that the curve peaks where the bet size is 20%. But how do we solve this anÂ­aÂ­lytÂ­iÂ­calÂ­ly? We want to be able to comÂ­pute the most opÂ­tiÂ­mal bet size. Letâ€™s use the folÂ­lowÂ­ing noÂ­taÂ­tion to repÂ­reÂ­sent the most opÂ­tiÂ­mal bet size:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-13-latex-1625569630.svg" alt="Figure 13" height="34"></figure><p>The deÂ­rivÂ­aÂ­tive of the growth rate funcÂ­tion is zeÂ­ro at the maxÂ­iÂ­mum, so we can say this:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-14-latex-0998881013.svg" alt="Figure 14" height="20"></figure><p>ExÂ­pandÂ­ing out the deÂ­rivÂ­aÂ­tive of the growth rate funcÂ­tion, we get this:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-15-latex-0928314274.svg" alt="Figure 15" height="35"></figure><p>SetÂ­ting the deÂ­rivÂ­aÂ­tive to zeÂ­ro, we can solve for the opÂ­tiÂ­mal bet size:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-16-latex-2271671085.svg" alt="Figure 16" height="39"></figure><p>We can simÂ­pliÂ­fy this furÂ­ther knowÂ­ing that the sum of the probÂ­aÂ­bilÂ­iÂ­ties adds up to one:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-17-latex-1181191844.svg" alt="Figure 17" height="17"></figure><p>Here is the simÂ­pliÂ­fied soÂ­luÂ­tion:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-18-latex-0907859635.svg" alt="Figure 18" height="19"></figure><p>And now, plugÂ­ging in the probÂ­aÂ­bilÂ­iÂ­ty valÂ­ues that quanÂ­tiÂ­fy the bias of the coin, we can comÂ­pute the anÂ­swer to our origÂ­iÂ­nal quesÂ­tion:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-19-latex-1613702162.svg" alt="Figure 19" height="15"></figure><p>Thus, our gamÂ­bler would maxÂ­iÂ­mize his winÂ­nings by betÂ­ting 20% of his curÂ­rent bankroll for each round of the coin toss game. We can even take it a step furÂ­ther and comÂ­pute his exÂ­pectÂ­ed growth for rate for a sinÂ­gle round of the game. ConÂ­sidÂ­er the reÂ­laÂ­tionÂ­ship beÂ­tween the origÂ­iÂ­nal growth rate funcÂ­tion and its logÂ­aÂ­rithÂ­mic equivÂ­aÂ­lenÂ­t:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-20-latex-2437147467.svg" alt="Figure 20" height="24"></figure><p>UsÂ­ing the opÂ­tiÂ­mal bet size, we can calÂ­cuÂ­late the opÂ­tiÂ­mal growth rate valÂ­ues:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-21-latex-1358914445.svg" alt="Figure 21" height="45"></figure><p>So now, if our gamÂ­bler bets 20% of his stake each round, he can exÂ­pect to inÂ­crease his wealth by 2.03% every time he plays. Of course, this is just an exÂ­pecÂ­taÂ­tion. The acÂ­tuÂ­al reÂ­sult will vary every round based on the ranÂ­domÂ­ness of the game.</p><h2 id="different-payoffs">DifÂ­ferÂ­ent PayÂ­offs</h2><p>In the preÂ­viÂ­ous exÂ­amÂ­ple, the winÂ­ning and losÂ­ing amounts were the same. In this exÂ­amÂ­ple, we are goÂ­ing to see what hapÂ­pens when there is an asymÂ­metÂ­ric payÂ­off rate. To make things inÂ­terÂ­estÂ­ing, we will start with a coin that onÂ­ly lands on heads 30% of the time and tails for the reÂ­mainÂ­ing 70% of the time:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-22-latex-4246536985.svg" alt="Figure 22" height="44"></figure><p>As with the preÂ­viÂ­ous exÂ­amÂ­ple, the gamÂ­bler alÂ­ways bets on headÂ­s. You might think this would be a losÂ­ing propoÂ­siÂ­tion since there will be more losÂ­ing rounds than winÂ­ning roundÂ­s. But if the payÂ­off for a winÂ­ning round is highÂ­er than the loss sufÂ­fered on a losÂ­ing round, the gamÂ­bler still might have an adÂ­vanÂ­tage when betÂ­ting on headÂ­s. In this case, letâ€™s say the gain is four times the loss:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-23-latex-0874922970.svg" alt="Figure 23" height="40"></figure><p>If the gamÂ­bler choosÂ­es a bet size of $1, he will onÂ­ly lose $1 if the coin lands on tailÂ­s. But if the coin lands on headÂ­s, he will gain $4. This is enough to offÂ­set the highÂ­er loss rate. We can now upÂ­date our modÂ­el of the game to acÂ­count for this type of asymÂ­metÂ­ric payÂ­ofÂ­f:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-24-latex-1846982524.svg" alt="Figure 24" height="30"></figure><p>So now the quesÂ­tion is, how much should the gamÂ­bler bet? What perÂ­centÂ­age of his holdÂ­ings should he waÂ­ger if he wants to maxÂ­iÂ­mize his winÂ­nings? We can do the same analyÂ­sis as beÂ­fore to come up with the logÂ­aÂ­rithÂ­mic growth rate as a funcÂ­tion of the bet size:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-25-latex-0492219510.svg" alt="Figure 25" height="19"></figure><p>This is simÂ­iÂ­lar to the growth rate funcÂ­tion in the preÂ­viÂ­ous exÂ­amÂ­ple. ExÂ­cept now, we have takÂ­en inÂ­to conÂ­sidÂ­erÂ­aÂ­tion the asymÂ­metÂ­ric payÂ­offÂ­s. Here is a plot of this funcÂ­tion:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-26-example-2-gs.svg" alt="Figure 26" height="405" width="720"></figure><p>Like we did in the preÂ­viÂ­ous exÂ­amÂ­ple, we can find the maxÂ­iÂ­mum growth rate by findÂ­ing the point at which the deÂ­rivÂ­aÂ­tive of the growth rate funcÂ­tion equals zeÂ­ro. Here is the deÂ­rivÂ­aÂ­tive of the growth rate funcÂ­tion:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-27-latex-0800878365.svg" alt="Figure 27" height="35"></figure><p>SetÂ­tings the deÂ­rivÂ­aÂ­tive to zeÂ­ro and solvÂ­ing for the bet size, we can arÂ­rive at the opÂ­tiÂ­mal bet size that maxÂ­iÂ­mizes the growth rate:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-28-latex-0402399174.svg" alt="Figure 28" height="37"></figure><p>PlugÂ­ging in the valÂ­ues, we get the conÂ­crete soÂ­luÂ­tion:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-29-latex-0518393300.svg" alt="Figure 29" height="15"></figure><p>And now we can evalÂ­uÂ­ate the growth rate funcÂ­tion at the opÂ­tiÂ­mal bet size:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-30-latex-0429245857.svg" alt="Figure 30" height="45"></figure><p>AcÂ­cordÂ­ing to these calÂ­cuÂ­laÂ­tionÂ­s, if the gamÂ­bler usÂ­es the opÂ­tiÂ­mal bet size of 12.5%, he can exÂ­pect to gain 2.86% every time he plays. DeÂ­spite losÂ­ing more ofÂ­ten than he winÂ­s, the gamÂ­bler can still make a profÂ­it unÂ­der the conÂ­diÂ­tions of this parÂ­ticÂ­uÂ­lar game.</p><h2 id="multiple-outcomes">MulÂ­tiÂ­ple OutÂ­comes</h2><p>This exÂ­amÂ­ple is a genÂ­erÂ­alÂ­izaÂ­tion of the preÂ­viÂ­ous ones. InÂ­stead of usÂ­ing a coin toss, here we conÂ­sidÂ­er a betÂ­ting game in which there are six posÂ­siÂ­ble outÂ­comes. Each outÂ­come has a difÂ­ferÂ­ent probÂ­aÂ­bilÂ­iÂ­ty. And each outÂ­come has a difÂ­ferÂ­ent payÂ­off rate. The folÂ­lowÂ­ing taÂ­ble shows the payÂ­offs and probÂ­aÂ­bilÂ­iÂ­ties of each outÂ­come:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-31-latex-2908102932.svg" alt="Figure 31" height="234"></figure><p>For our analyÂ­sis, letâ€™s use the folÂ­lowÂ­ing noÂ­taÂ­tion to repÂ­reÂ­sent the payÂ­off maÂ­trix above:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-32-latex-0290726690.svg" alt="Figure 32" height="150"></figure><p>NoÂ­tice that, like in the preÂ­viÂ­ous exÂ­amÂ­ples, the sum of the probÂ­aÂ­bilÂ­iÂ­ties adds up to one:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-33-latex-3477990014.svg" alt="Figure 33" height="53"></figure><p>Since there is a 10% chance that we can lose twice the bet size, there is an imÂ­plicÂ­it hard limÂ­it on the maxÂ­iÂ­mum posÂ­siÂ­ble bet size at 50%. We will adÂ­dress these kinds of limÂ­iÂ­taÂ­tions in a latÂ­er secÂ­tion. For now, here is the growth rate funcÂ­tion that we want to maxÂ­iÂ­mize:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-34-latex-3981404821.svg" alt="Figure 34" height="53"></figure><p>While there are six posÂ­siÂ­ble outÂ­comes in this exÂ­amÂ­ple, there can be an arÂ­biÂ­trary numÂ­ber of posÂ­siÂ­ble outÂ­comes in the genÂ­erÂ­al case. BeÂ­cause of this, it is best to repÂ­reÂ­sent the growth rate funcÂ­tion as a sumÂ­maÂ­tion. Here is a plot of the growth rate funcÂ­tion:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-35-example-3-gs.svg" alt="Figure 35" height="405" width="720"></figure><p>Now at this point, we might try the same apÂ­proach that we did beÂ­fore in the last two exÂ­amÂ­ples. We can take the deÂ­rivÂ­aÂ­tive of the growth rate funcÂ­tion and then find the point at which the deÂ­rivÂ­aÂ­tive is equal to zeÂ­ro. But look at this deÂ­rivÂ­aÂ­tive:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-36-latex-3362018836.svg" alt="Figure 36" height="53"></figure><p>Can you solve this? Go ahead and try it. But it might just be easÂ­iÂ­er to use a nuÂ­merÂ­iÂ­cal root-findÂ­ing method. And if youâ€™re goÂ­ing to use a nuÂ­merÂ­iÂ­cal method, you might alÂ­so conÂ­sidÂ­er usÂ­ing a nuÂ­merÂ­iÂ­cal opÂ­tiÂ­mizaÂ­tion method on the growth rate funcÂ­tion itÂ­self inÂ­stead of bothÂ­erÂ­ing with the deÂ­rivÂ­aÂ­tive. I deÂ­cidÂ­ed to use the Nelderâ€“Mead method imÂ­pleÂ­mentÂ­ed by a third-parÂ­ty liÂ­brary to find the bet size valÂ­ue that maxÂ­iÂ­mizes the growth rate funcÂ­tion. Here is the reÂ­sult:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-37-latex-2185643889.svg" alt="Figure 37" height="16"></figure><p>And now, we can plug this valÂ­ue inÂ­to the growth rate funcÂ­tion:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-38-latex-2537052427.svg" alt="Figure 38" height="45"></figure><p>For this game, the opÂ­tiÂ­mal bet size is 15.71%. The gamÂ­bler can exÂ­pect to grow his wealth by 2.35% every round if he plays the opÂ­tiÂ­mal bet size. NoÂ­tice that, in this case, unÂ­like the last two exÂ­amÂ­ples, the bet size valÂ­ue does not repÂ­reÂ­sent the maxÂ­iÂ­mum amount the gamÂ­bler stands to lose. InÂ­stead, it is simÂ­ply a mulÂ­tiÂ­pliÂ­er or a scalÂ­ing facÂ­tor. Based on the payÂ­off maÂ­trix for this parÂ­ticÂ­uÂ­lar exÂ­amÂ­ple, the gamÂ­bler can lose up with twice the bet size on any givÂ­en round.</p><h2 id="stock-trading">Stock TradÂ­ing</h2><p>Now letâ€™s see how to apÂ­ply this opÂ­tiÂ­mal bet sizÂ­ing techÂ­nique to stock tradÂ­ing. You can think of stock marÂ­ket tradÂ­ing as a form of gamÂ­bling. That is the best analÂ­oÂ­gy. SupÂ­pose the gamÂ­blerâ€”or the trader, if you want to call him thatâ€”specÂ­uÂ­lates that the price of a stock will close at one of six posÂ­siÂ­ble price points afÂ­ter a speÂ­cifÂ­ic amount of time:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-39-latex-0131405676.svg" alt="Figure 39" height="150"></figure><p>The price points range from as low as $18 per share to as high as $23 per share, and the gamÂ­blerâ€™s hyÂ­pothÂ­eÂ­sis asÂ­soÂ­ciates difÂ­ferÂ­ent probÂ­aÂ­bilÂ­iÂ­ties with each outÂ­come. Letâ€™s asÂ­sume that the stock has a curÂ­rent marÂ­ket valÂ­ue of $20 per share:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-40-latex-1003122082.svg" alt="Figure 40" height="14"></figure><p>This is the price point at which the tradÂ­er can enÂ­ter inÂ­to a poÂ­siÂ­tion. To deÂ­terÂ­mine the payÂ­off rate for each posÂ­siÂ­ble outÂ­come, we can use a payÂ­off funcÂ­tion that takes the enÂ­try price inÂ­to conÂ­sidÂ­erÂ­aÂ­tion. Here is the payÂ­off funcÂ­tion:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-41-latex-2614500131.svg" alt="Figure 41" height="35"></figure><p>Here are the comÂ­putÂ­ed payÂ­off valÂ­ues for each one of the posÂ­siÂ­ble outÂ­comes:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-42-latex-2333456418.svg" alt="Figure 42" height="152"></figure><p>Here is the growth rate funcÂ­tion that we want to maxÂ­iÂ­mize:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-43-latex-0123407481.svg" alt="Figure 43" height="53"></figure><p>NoÂ­tice how the growth rate funcÂ­tion usÂ­es the payÂ­off funcÂ­tion inÂ­side the sumÂ­maÂ­tion. PlotÂ­ting this funcÂ­tion on a chart, here is what it looks like:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-44-example-4-gs.svg" alt="Figure 44" height="405" width="720"></figure><p>As with the preÂ­viÂ­ous exÂ­amÂ­ple, we can use a nuÂ­merÂ­iÂ­cal opÂ­tiÂ­mizaÂ­tion method to find the most opÂ­tiÂ­mal bet size that maxÂ­iÂ­mizes the growth rate. Here is the reÂ­sult:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-45-latex-4142433282.svg" alt="Figure 45" height="16"></figure><p>This valÂ­ue is greater than one. What does this mean? It means that our tradÂ­er would have to use leverÂ­age if he wants to take the most opÂ­tiÂ­mal poÂ­siÂ­tion in this stock. A tradÂ­er with a $10,000 acÂ­count would have to buy $31,422 worth of this stockÂ­â€”about 1,571 shares. UsÂ­ing this amount of leverÂ­age may or may not be posÂ­siÂ­ble. AsÂ­sumÂ­ing it is, here is the exÂ­pectÂ­ed growth rate:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-46-latex-2537052427.svg" alt="Figure 46" height="45"></figure><p>NoÂ­tice the simÂ­iÂ­larÂ­iÂ­ty to the preÂ­viÂ­ous exÂ­amÂ­ple. In facÂ­t, this is a reÂ­peat of the preÂ­viÂ­ous exÂ­amÂ­ple. The onÂ­ly difÂ­ferÂ­ence is that the payÂ­off valÂ­ues are scaled down by a facÂ­tor of twenÂ­ty. And this reÂ­sults in the opÂ­tiÂ­mal bet size beÂ­ing scaled up by a facÂ­tor of twenÂ­ty. But the opÂ­tiÂ­mal growth rate reÂ­mains the same for both exÂ­amÂ­ples.</p><h2 id="continuous-distributions">ConÂ­tinÂ­uÂ­ous DisÂ­triÂ­bÂ­uÂ­tions</h2><p>The preÂ­viÂ­ous exÂ­amÂ­ple used what is baÂ­siÂ­calÂ­ly a disÂ­crete probÂ­aÂ­bilÂ­iÂ­ty mass funcÂ­tion to modÂ­el the proÂ­jectÂ­ed beÂ­havÂ­ior of stock price moveÂ­ments. Since stock prices can move along a conÂ­tinÂ­uÂ­ous range of valÂ­ues, it might be more reÂ­alÂ­isÂ­tic to use a conÂ­tinÂ­uÂ­ous modÂ­el inÂ­stead of a disÂ­crete modÂ­el. In this exÂ­amÂ­ple, we will use a log-norÂ­mal probÂ­aÂ­bilÂ­iÂ­ty denÂ­siÂ­ty funcÂ­tion:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-47-latex-2908599828.svg" alt="Figure 47" height="47"></figure><p>This funcÂ­tion ranges from zeÂ­ro to inÂ­finÂ­iÂ­ty, and the area unÂ­der the curve is one:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-48-latex-2899447321.svg" alt="Figure 48" height="50"></figure><p>For a log-norÂ­mal probÂ­aÂ­bilÂ­iÂ­ty denÂ­siÂ­ty funcÂ­tion, we need to proÂ­vide apÂ­proÂ­priÂ­ate valÂ­ues for the mean and the stanÂ­dard deÂ­viÂ­aÂ­tion. How to come up with these valÂ­ues is beÂ­yond the scope of this disÂ­cusÂ­sion, so we will just make up some ficÂ­tiÂ­tious numÂ­bers for the sake of exÂ­amÂ­ple:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-49-latex-2995049220.svg" alt="Figure 49" height="45"></figure><p>UsÂ­ing these valÂ­ues for the mean and stanÂ­dard deÂ­viÂ­aÂ­tion, we can plot the probÂ­aÂ­bilÂ­iÂ­ty denÂ­siÂ­ty funcÂ­tion to see what it looks like. Here is the plot:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-50-example-5-ps.svg" alt="Figure 50" height="405" width="720"></figure><p>This is our specÂ­uÂ­laÂ­tive foreÂ­cast of what the stock price might be afÂ­ter a speÂ­cifÂ­ic amount of time has passed. As you can see from lookÂ­ing at the chart, the price is most likeÂ­ly to fall someÂ­where beÂ­tween $15 per share and $25 per share. But there is a small chance that it could fall outÂ­side this range as well. For this exÂ­amÂ­ple, we will asÂ­sume the curÂ­rent price at which we can enÂ­ter inÂ­to a poÂ­siÂ­tion is $20 per share, and we will bound the exÂ­it point to someÂ­where beÂ­tween $17 per share and $23 per share:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-51-latex-4017371784.svg" alt="Figure 51" height="67"></figure><p>We are asÂ­sumÂ­ing ideÂ­alÂ­ized exÂ­it point boundÂ­aries here. We can nevÂ­er gain or lose more than $3 per share. In reÂ­alÂ­iÂ­ty, enÂ­forceÂ­ment of this boundÂ­ary conÂ­diÂ­tion might take the form of a stop-loss orÂ­der at $17 and a take-profÂ­it orÂ­der at $23. Or it might alÂ­so take the form of a long poÂ­siÂ­tion in a put opÂ­tion with a strike price of $17 and a short poÂ­siÂ­tion in a call opÂ­tion with a strike price of $23, disÂ­reÂ­gardÂ­ing any preÂ­miÂ­ums paid or reÂ­ceived. UsÂ­ing these valÂ­ues, here is our payÂ­off funcÂ­tion:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-52-latex-2476818120.svg" alt="Figure 52" height="136"></figure><p>This payÂ­off funcÂ­tion is a pieceÂ­wise funcÂ­tion that limÂ­its the loss and caps the gain at the exÂ­it point boundÂ­aries. While this funcÂ­tion is not necÂ­esÂ­sarÂ­iÂ­ly difÂ­ferÂ­enÂ­tiable at all points, note that it is conÂ­tinÂ­uÂ­ous at all points. Here is a graphÂ­iÂ­cal repÂ­reÂ­senÂ­taÂ­tion of this funcÂ­tion:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-53-example-5-ws.svg" alt="Figure 53" height="405" width="720"></figure><p>GivÂ­en the conÂ­tinÂ­uÂ­ous probÂ­aÂ­bilÂ­iÂ­ty denÂ­siÂ­ty funcÂ­tion and the conÂ­tinÂ­uÂ­ous payÂ­off funcÂ­tion, we can now comÂ­pute the exÂ­pectÂ­ed growth rate as a funcÂ­tion of the bet size. InÂ­stead of usÂ­ing a sumÂ­maÂ­tion as we did preÂ­viÂ­ousÂ­ly, in this exÂ­amÂ­ple, we will use an inÂ­teÂ­gral:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-54-latex-1515119160.svg" alt="Figure 54" height="50"></figure><p>This is the growth rate funcÂ­tion that we want to maxÂ­iÂ­mize. Since the payÂ­off funcÂ­tion used here is a pieceÂ­wise funcÂ­tion, we might want to break this inÂ­teÂ­gral up inÂ­to three difÂ­ferÂ­ent parÂ­tiÂ­tionÂ­s:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-55-latex-1328449645.svg" alt="Figure 55" height="50"></figure><p>I have not figÂ­ured out how to boil this inÂ­teÂ­gral down to an exÂ­presÂ­sion in anÂ­aÂ­lytÂ­ic forÂ­m. In parÂ­ticÂ­uÂ­lar, it is the midÂ­dle parÂ­tiÂ­tion I have not been able to find the soÂ­luÂ­tion for. HowÂ­evÂ­er, this probÂ­lem can be solved usÂ­ing nuÂ­merÂ­iÂ­cal inÂ­teÂ­graÂ­tion. In this case, I am usÂ­ing the Gaussâ€“LeÂ­gendre method to find an apÂ­proxÂ­iÂ­maÂ­tion. Here is what this funcÂ­tion looks like on a chart:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-56-example-5-gs.svg" alt="Figure 56" height="405" width="720"></figure><p>UsÂ­ing nuÂ­merÂ­iÂ­cal opÂ­tiÂ­mizaÂ­tion on top of nuÂ­merÂ­iÂ­cal inÂ­teÂ­graÂ­tion, we can comÂ­pute the opÂ­tiÂ­mal bet size that maxÂ­iÂ­mizes the growth rate funcÂ­tion. Here is the reÂ­sult:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-57-latex-0108436737.svg" alt="Figure 57" height="16"></figure><p>Just like the preÂ­viÂ­ous exÂ­amÂ­ple, this is a leverÂ­aged poÂ­siÂ­tion. Here is the maxÂ­iÂ­mum growth rate usÂ­ing the opÂ­tiÂ­mal bet size:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-58-latex-2226279349.svg" alt="Figure 58" height="45"></figure><p>AdÂ­mitÂ­tedÂ­ly, this exÂ­amÂ­ple is a bit ideÂ­alÂ­isÂ­tic. It asÂ­sumes that the tradÂ­er can reÂ­peat the same bet again and again. But in reÂ­al life, marÂ­ket conÂ­diÂ­tions can change over time. The price point where the tradÂ­er can enÂ­ter a poÂ­siÂ­tion can change as the tide of the marÂ­ket goes up and down, changÂ­ing the payÂ­off funcÂ­tion. And the probÂ­aÂ­bilÂ­iÂ­ty disÂ­triÂ­bÂ­uÂ­tion of the proÂ­jectÂ­ed price moveÂ­ments can change as well. In facÂ­t, the price moveÂ­ments might be difÂ­fiÂ­cult to modÂ­el acÂ­cuÂ­rateÂ­ly in the first place.</p><h2 id="short-positions">Short PoÂ­siÂ­tions</h2><p>The opÂ­tiÂ­mal bet size does not alÂ­ways have to be a posÂ­iÂ­tive numÂ­ber. SomeÂ­times it can be a negÂ­aÂ­tive numÂ­ber. A negÂ­aÂ­tive numÂ­ber can inÂ­diÂ­cate that the bet on ofÂ­fer is a losÂ­ing bet that is not worth takÂ­ing. It might alÂ­so repÂ­reÂ­sent an opÂ­porÂ­tuÂ­niÂ­ty for profÂ­it if the gamÂ­bler is able to take the othÂ­er side of the bet. For a stock trader, a negÂ­aÂ­tive valÂ­ue inÂ­diÂ­cates that the most adÂ­vanÂ­taÂ­geous thing to do would be to take a short poÂ­siÂ­tion. Letâ€™s reÂ­peat the preÂ­viÂ­ous exÂ­amÂ­ple usÂ­ing a slightÂ­ly difÂ­ferÂ­ent probÂ­aÂ­bilÂ­iÂ­ty denÂ­siÂ­ty funcÂ­tion. Weâ€™ll use the folÂ­lowÂ­ing mean and stanÂ­dard deÂ­viÂ­aÂ­tion valÂ­ues:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-59-latex-4148413365.svg" alt="Figure 59" height="45"></figure><p>Here is a plot of the log-norÂ­mal probÂ­aÂ­bilÂ­iÂ­ty denÂ­siÂ­ty funcÂ­tion usÂ­ing these valÂ­ues:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-60-example-6-ps.svg" alt="Figure 60" height="405" width="720"></figure><p>The peak of the curve is shiftÂ­ed a bit to the left comÂ­pared to the denÂ­siÂ­ty funcÂ­tion used in the preÂ­viÂ­ous exÂ­amÂ­ple. For this exÂ­amÂ­ple, we are goÂ­ing to use the same enÂ­try price and exÂ­it point boundÂ­aries that we used in the preÂ­viÂ­ous exÂ­amÂ­ple:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-61-latex-4017371784.svg" alt="Figure 61" height="67"></figure><p>As you might exÂ­pecÂ­t, the payÂ­off funcÂ­tion is exÂ­actÂ­ly the same as well:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-62-example-6-ws.svg" alt="Figure 62" height="405" width="720"></figure><p>The exÂ­pectÂ­ed valÂ­ue of the growth rate as a funcÂ­tion of the bet size looks like this:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-63-example-6-gs.svg" alt="Figure 63" height="405" width="720"></figure><p>NoÂ­tice the maxÂ­iÂ­mum valÂ­ue apÂ­pears on the negÂ­aÂ­tive side of the verÂ­tiÂ­cal axÂ­is this time around. ComÂ­putÂ­ing the opÂ­tiÂ­mal bet size nuÂ­merÂ­iÂ­calÂ­ly, this is the reÂ­sult:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-64-latex-2407794594.svg" alt="Figure 64" height="15"></figure><p>It is a negÂ­aÂ­tive numÂ­ber, inÂ­diÂ­catÂ­ing that the tradÂ­er should sell the stock short. Here is the exÂ­pectÂ­ed growth rate calÂ­cuÂ­laÂ­tion if the tradÂ­er takes the opÂ­tiÂ­malÂ­ly sized short poÂ­siÂ­tion:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-65-latex-3987495252.svg" alt="Figure 65" height="45"></figure><p>I think itâ€™s worth menÂ­tionÂ­ing here that this reÂ­sult is the poÂ­lar opÂ­poÂ­site of the opÂ­tiÂ­mal bet size valÂ­ue found in the preÂ­viÂ­ous exÂ­amÂ­ple. This is surÂ­prisÂ­ing beÂ­cause these two exÂ­amÂ­ples are nearÂ­ly idenÂ­tiÂ­cal. The onÂ­ly difÂ­ferÂ­ence is in the mean and stanÂ­dard deÂ­viÂ­aÂ­tion valÂ­ues used in the probÂ­aÂ­bilÂ­iÂ­ty denÂ­siÂ­ty funcÂ­tionÂ­s. And the difÂ­ferÂ­ence isÂ­nâ€™t that great. The two probÂ­aÂ­bilÂ­iÂ­ty denÂ­siÂ­ties are not that much difÂ­ferÂ­ent from one anÂ­othÂ­er. I think this ilÂ­lusÂ­trates how senÂ­siÂ­tive this bet size opÂ­tiÂ­mizaÂ­tion techÂ­nique is to the acÂ­cuÂ­raÂ­cy of the modÂ­el used to quanÂ­tiÂ­fy the game.</p><h2 id="constraints-and-limitations">ConÂ­straints and LimÂ­iÂ­taÂ­tions</h2><p>As alÂ­ludÂ­ed to earÂ­liÂ­er when disÂ­cussing mulÂ­tiÂ­ple outÂ­comes, there are hard limÂ­its to how much a gamÂ­bler can bet or how much leverÂ­age a tradÂ­er can use. When usÂ­ing the KelÂ­ly criÂ­teÂ­riÂ­on, if there is any chance at alÂ­l, no matÂ­ter how small it might be, that the gamÂ­bler can lose his enÂ­tire stake on any one round of the game, then the exÂ­pectÂ­ed growth rate is zeÂ­ro. This is the exÂ­treme case of the gamÂ­bler betÂ­ting an amount highÂ­er in magÂ­niÂ­tude than the opÂ­tiÂ­mal bet size. In the stock tradÂ­ing modÂ­el ilÂ­lusÂ­tratÂ­ed in the last two exÂ­amÂ­ples, we must take these limÂ­its inÂ­to conÂ­sidÂ­erÂ­aÂ­tion when alÂ­lowÂ­ing the tradÂ­er to take a leverÂ­aged poÂ­siÂ­tion. SupÂ­pose a tradÂ­er takes a poÂ­siÂ­tion in a stock at an enÂ­try price of $20 per share:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-66-latex-1003122082.svg" alt="Figure 66" height="14"></figure><p>SetÂ­ting the lowÂ­er exÂ­it point valÂ­ue to $15 per share would conÂ­strain the maxÂ­iÂ­mum bet size for a long poÂ­siÂ­tion to four times the tradÂ­erâ€™s acÂ­count valÂ­ue. If the trader were to lose more than $5 per share with this amount of leverÂ­age, his acÂ­count would go inÂ­to negÂ­aÂ­tive terÂ­riÂ­toÂ­ry. LikeÂ­wise, takÂ­ing a short poÂ­siÂ­tion with this amount of leverÂ­age would conÂ­strain the upÂ­per exÂ­it point valÂ­ue to no more than $25 per share. Here is how to calÂ­cuÂ­late the exÂ­it point limÂ­its in reÂ­laÂ­tion to the bet size:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-67-latex-0521437764.svg" alt="Figure 67" height="172"></figure><p>For a long poÂ­siÂ­tion, there is efÂ­fecÂ­tiveÂ­ly no limÂ­it to the upÂ­per exÂ­it point. It can go to inÂ­finÂ­iÂ­ty. And for a short poÂ­siÂ­tion, the lowÂ­er exÂ­it point can go all the way to zeÂ­ro withÂ­out putting any reÂ­stricÂ­tions on the bet size. In the case of an unÂ­leverÂ­aged long poÂ­siÂ­tion, both the lowÂ­er and the upÂ­per exÂ­it points can be unÂ­limÂ­itÂ­ed. Here is a plot of the forÂ­muÂ­las above to give a viÂ­suÂ­al ilÂ­lusÂ­traÂ­tion:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-68-limitations-1.svg" alt="Figure 68" height="405" width="720"></figure><p>The solÂ­id lines show the hard limÂ­its that conÂ­strain the upÂ­per and lowÂ­er exÂ­it points. The shadÂ­ed reÂ­gions show the valid arÂ­eas where the exÂ­it points can be placed. But this doesÂ­nâ€™t tell the whole stoÂ­ry. The stock traderâ€™s broÂ­ker might have marÂ­gin reÂ­quireÂ­ments that imÂ­pose adÂ­diÂ­tionÂ­al conÂ­straints on the above. SupÂ­pose the broÂ­ker has a 50% iniÂ­tial marÂ­gin reÂ­quireÂ­ment to enÂ­ter inÂ­to a poÂ­siÂ­tion and a 25% mainÂ­teÂ­nance marÂ­gin reÂ­quireÂ­menÂ­t:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-69-latex-2518989079.svg" alt="Figure 69" height="41"></figure><p>The iniÂ­tial marÂ­gin reÂ­quireÂ­ment puts a cap on the magÂ­niÂ­tude of the bet size. The alÂ­lowÂ­able range of bet size valÂ­ues is inÂ­verseÂ­ly proÂ­porÂ­tionÂ­al to the iniÂ­tial marÂ­gin reÂ­quireÂ­menÂ­t:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-70-latex-2064295291.svg" alt="Figure 70" height="18"></figure><p>We can alÂ­so use the folÂ­lowÂ­ing noÂ­taÂ­tion to deÂ­scribe the exÂ­tremes of the bet size valÂ­ues:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-71-latex-4016820844.svg" alt="Figure 71" height="50"></figure><p>TakÂ­ing the mainÂ­teÂ­nance marÂ­gin reÂ­quireÂ­ment inÂ­to conÂ­sidÂ­erÂ­aÂ­tion, we can now reÂ­vise the forÂ­muÂ­las for the exÂ­it point limÂ­itÂ­s:</p><figure class="fig-latex"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-72-latex-1128790658.svg" alt="Figure 72" height="179"></figure><p>The marÂ­gin reÂ­quireÂ­ments add adÂ­diÂ­tionÂ­al conÂ­straints both horÂ­iÂ­zonÂ­talÂ­ly and verÂ­tiÂ­calÂ­ly. Here is the reÂ­vised viÂ­suÂ­alÂ­izaÂ­tion:</p><figure class="fig-chart" style="padding-top: 56.25%;"><img src="./2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/fig-73-limitations-2.svg" alt="Figure 73" height="405" width="720"></figure><p>As you can see, the range of exÂ­it point valÂ­ues that would alÂ­low the tradÂ­er to avoid a marÂ­gin call is a subÂ­set of the range of valÂ­ues that can be conÂ­sidÂ­ered unÂ­der the KelÂ­ly criÂ­teÂ­riÂ­on. To perÂ­form the opÂ­tiÂ­mal bet size analyÂ­sis unÂ­der these conÂ­straints, there are difÂ­ferÂ­ent apÂ­proachÂ­es you can take. You might try setÂ­ting the exÂ­it point valÂ­ues to the upÂ­per and lowÂ­er limÂ­its for the most exÂ­treme bet size valÂ­ues and then perÂ­formÂ­ing the opÂ­tiÂ­mizaÂ­tion proÂ­ceÂ­dure to find the most opÂ­tiÂ­mal bet size across all posÂ­siÂ­ble bet size valÂ­ues. AlÂ­terÂ­naÂ­tiveÂ­ly, you might choose the exÂ­it point valÂ­ues first based on some criÂ­teÂ­ria and then limÂ­it the range of posÂ­siÂ­ble bet size valÂ­ues to those that alÂ­low for the choÂ­sen range of exÂ­it points.</p><h2 id="psychology-and-variances">PsyÂ­cholÂ­oÂ­gy and VariÂ­ances</h2><p>In adÂ­diÂ­tion to the hard limÂ­its deÂ­scribed above, there may alÂ­so be some soft limÂ­its to how big the bet size can be. The foÂ­cus of this study has been on findÂ­ing the most opÂ­tiÂ­mal bet size, but we did not adÂ­dress the variÂ­ance of posÂ­siÂ­ble outÂ­comes for a reÂ­peatÂ­ed betÂ­ting game. Even when there is a posÂ­iÂ­tive exÂ­pecÂ­taÂ­tion, the gamÂ­bler may exÂ­peÂ­riÂ­ence losÂ­ing streaks that cause him to secÂ­ond guess himÂ­self. TakÂ­ing the most opÂ­tiÂ­mal bet size might be a psyÂ­choÂ­logÂ­iÂ­calÂ­ly difÂ­fiÂ­cult thing to do, and the gamÂ­bler might be more comÂ­fortÂ­able takÂ­ing a smallÂ­er bet. It might be worth doÂ­ing a furÂ­ther study to unÂ­derÂ­stand how much variÂ­aÂ­tion the gamÂ­bler might exÂ­pect in the posÂ­siÂ­ble outÂ­comes of playÂ­ing a reÂ­peatÂ­ed game of chance.</p><p class="nojustify"><a href="https://github.com/jkillingsworth/jkillingsworth.com/tree/master/src/2022-06-06-using-the-kelly-criterion-for-optimal-bet-sizing">AcÂ­comÂ­paÂ­nyÂ­ing source code is availÂ­able on GitHub.</a></p><footer><time datetime="2022-06-06">June 6, 2022</time></footer></article><section class="comments"><header><h2>ComÂ­ments</h2></header><script>
    var disqus_config = function () {
      this.page.url = "https://jkillingsworth.com/2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/";
      this.page.title = "Using the Kelly Criterion for Optimal Bet Sizing";
      this.page.identifier = "/2022/06/06/using-the-kelly-criterion-for-optimal-bet-sizing/";
    };
    function disqus_show() {
      var d = document, s = d.createElement("script");
      s.src = "https://jkillingsworth.disqus.com/embed.js";
      s.setAttribute("data-timestamp", +new Date());
      (d.head || d.body).appendChild(s);
    }
    function anchor_blur() {
      var a = document.getElementById("comments");
      a.innerText = "Comments";
      a.blur();
    }
    function disqus() {
      disqus_show();
      anchor_blur();
    }
  </script><a href="javascript:disqus();" id="comments" class="button">Show comments</a><div id="disqus_thread"></div><noscript> Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></section></main><aside class="sidebar"><header><h1>Sidebar</h1></header><section class="social-media"><header><h2>Social Media</h2></header><ul><li><a href="https://www.linkedin.com/in/jkillingsworth/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M417.2 64H96.8C79.3 64 64 76.6 64 93.9V415c0 17.4 15.3 32.9 32.8 32.9h320.3c17.6 0 30.8-15.6 30.8-32.9V93.9C448 76.6 434.7 64 417.2 64zM183 384h-55V213h55v171zm-25.6-197h-.4c-17.6 0-29-13.1-29-29.5 0-16.7 11.7-29.5 29.7-29.5s29 12.7 29.4 29.5c0 16.4-11.4 29.5-29.7 29.5zM384 384h-55v-93.5c0-22.4-8-37.7-27.9-37.7-15.2 0-24.2 10.3-28.2 20.3-1.5 3.6-1.9 8.5-1.9 13.5V384h-55V213h55v23.8c8-11.4 20.5-27.8 49.6-27.8 36.1 0 63.4 23.8 63.4 75.1V384z"/></svg><span>LinkedIn</span></a></li><li><a href="https://github.com/jkillingsworth/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 32C132.3 32 32 134.9 32 261.7c0 101.5 64.2 187.5 153.2 217.9 1.4.3 2.6.4 3.8.4 8.3 0 11.5-6.1 11.5-11.4 0-5.5-.2-19.9-.3-39.1-8.4 1.9-15.9 2.7-22.6 2.7-43.1 0-52.9-33.5-52.9-33.5-10.2-26.5-24.9-33.6-24.9-33.6-19.5-13.7-.1-14.1 1.4-14.1h.1c22.5 2 34.3 23.8 34.3 23.8 11.2 19.6 26.2 25.1 39.6 25.1 10.5 0 20-3.4 25.6-6 2-14.8 7.8-24.9 14.2-30.7-49.7-5.8-102-25.5-102-113.5 0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8 0 0 1.6-.5 5-.5 8.1 0 26.4 3.1 56.6 24.1 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 30.2-21 48.5-24.1 56.6-24.1 3.4 0 5 .5 5 .5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6 0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5 0 30.7-.3 55.5-.3 63 0 5.4 3.1 11.5 11.4 11.5 1.2 0 2.6-.1 4-.4C415.9 449.2 480 363.1 480 261.7 480 134.9 379.7 32 256 32z"/></svg><span>GitHub</span></a></li></ul></section></aside><footer> &copy; 2018&ndash;2022 Jim Killingsworth. All rights reserved. </footer></body></html>